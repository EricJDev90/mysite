import{Sa as n,Ta as s,Ua as l,Za as u,hb as o,za as m}from"./chunk-JMXXPQVF.js";import{a as d}from"./chunk-P2ORHKTI.js";var p=(()=>{let a=class a{constructor(){this.lastRenderTime=0,this.inputDirection={x:0,y:0},this.lastInputDirection={x:0,y:0},this.food={x:10,y:5},this.newSegments=0,this.score=0,this.gamestarted=!1,this.gameOver=!1,this.pageWidth=window.innerWidth,this.threshold=Math.max(1,Math.floor(.01*this.pageWidth)),this.limit=Math.tan(45*1.5/180*Math.PI),this.preventNewMovement=!1,this.touchstartX=0,this.touchstartY=0,this.touchendX=0,this.touchendY=0,this.SNAKE_SPEED=4,this.EXPANSION_RATE=1,this.GRID_SIZE=21,this.snakeBody=[{x:11,y:11}],this.gameBoard=null,this.scoreBoard=null,this.startbutton=null,this.splashScreen=null}ngOnInit(){this.splashScreen=document.getElementById("splashscreen"),this.gameBoard=document.getElementById("game-board"),this.scoreBoard=document.getElementById("score-board"),this.startbutton=document.getElementById("startbutton"),window.addEventListener("keydown",t=>{t.key=="Enter"&&this.startFunction()})}startFunction(){this.gamestarted||(this.splashScreen&&(this.splashScreen.style.display="none"),this.gameBoard&&(this.gameBoard.style.display="grid"),this.enableControls(),this.gamestarted=!0,this.main())}enableControls(){this.gameBoard&&(this.gameBoard&&(this.gameBoard.addEventListener("touchstart",t=>{this.touchstartX=t.changedTouches[0].screenX,this.touchstartY=t.changedTouches[0].screenY},!1),this.gameBoard.addEventListener("touchend",t=>{this.touchendX=t.changedTouches[0].screenX,this.touchendY=t.changedTouches[0].screenY,this.handleGesure()},!1)),window.addEventListener("keydown",t=>{if(!this.preventNewMovement)switch(t.key){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight();break}}))}handleGesure(){if(!this.preventNewMovement){let t=this.touchendX-this.touchstartX,e=this.touchendY-this.touchstartY,i=Math.abs(t/e),r=Math.abs(e/t);(Math.abs(t)>this.threshold||Math.abs(e)>this.threshold)&&(r<=this.limit&&(t<0?this.moveLeft():this.moveRight()),i<=this.limit&&(e<0?this.moveUp():this.moveDown()))}}moveUp(){this.lastInputDirection.y!==1&&(this.inputDirection={x:0,y:-1},this.lastInputDirection=this.inputDirection,this.preventNewMovement=!0)}moveDown(){this.lastInputDirection.y!==-1&&(this.inputDirection={x:0,y:1},this.lastInputDirection=this.inputDirection,this.preventNewMovement=!0)}moveLeft(){this.lastInputDirection.x!==1&&(this.inputDirection={x:-1,y:0},this.lastInputDirection=this.inputDirection,this.preventNewMovement=!0)}moveRight(){this.lastInputDirection.x!==-1&&(this.inputDirection={x:1,y:0},this.lastInputDirection=this.inputDirection,this.preventNewMovement=!0)}main(t){this.main&&window.requestAnimationFrame(this.main.bind(this));let e=(t-this.lastRenderTime)/1e3,i=1/(this.SNAKE_SPEED+this.snakeBody.length*.5);e<i||(this.lastRenderTime=t,this.update(),this.draw())}drawSnake(t){this.snakeBody.forEach(e=>{var r,c;let i=document.createElement("div");i.style.gridRowStart=(r=e.y)==null?void 0:r.toString(),i.style.gridColumnStart=(c=e.x)==null?void 0:c.toString(),i.style.backgroundColor="black",t.appendChild(i)})}draw(){this.gameBoard.innerHTML="",this.drawSnake(this.gameBoard),this.drawFood(this.gameBoard)}update(){for(let t=this.snakeBody.length-2;t>=0;t--)this.snakeBody[t+1]=d({},this.snakeBody[t]);this.snakeBody[0].x+=this.inputDirection.x,this.snakeBody[0].y+=this.inputDirection.y,this.onSnake(this.food)&&(this.addSegments(this.EXPANSION_RATE),this.food=this.getRandomFoodPosition()),this.checkDeath(),this.preventNewMovement=!1}drawFood(t){let e=document.createElement("div");e.style.gridRowStart=this.food.y.toString(),e.style.gridColumnStart=this.food.x.toString(),e.style.backgroundColor="red",t.appendChild(e)}onSnake(t,{ignoreHead:e=!1}={}){return this.snakeBody.some((i,r)=>e&&r===0?!1:this.equalPositions(i,t))}equalPositions(t,e){return t.x===e.x&&t.y===e.y}addSegments(t){this.newSegments+=t,this.updateScore();for(let e=0;e<this.newSegments;e++)this.snakeBody.push(d({},this.snakeBody[this.snakeBody.length]));this.newSegments=0}getRandomFoodPosition(){let t;for(;t==null||this.onSnake(t);)t=this.randomGridPosition();return t}randomGridPosition(){return{x:Math.floor(Math.random()*this.GRID_SIZE)+1,y:Math.floor(Math.random()*this.GRID_SIZE)+1}}checkDeath(){this.gameOver=this.outsideGrid(this.snakeBody[0])||this.snakeIntersection(),this.gameOver&&window.location.reload()}outsideGrid(t){return t.x<1||t.x>this.GRID_SIZE||t.y<1||t.y>this.GRID_SIZE}snakeIntersection(){return this.onSnake(this.snakeBody[0],{ignoreHead:!0})}updateScore(){this.scoreBoard.innerHTML=(this.score+=10).toString()}};a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=m({type:a,selectors:[["snake"]],decls:21,vars:0,consts:[[1,"padding-top-100px"],["id","score-board"],[1,"snake-page"],["id","game-board"],["id","splashscreen"],["id","splashscreen-content"],["id","startbutton","type","button","value","Start",3,"click"],["id","controls-style"]],template:function(e,i){e&1&&(n(0,"h2",0),o(1,"Score:"),s(),n(2,"h2",1),o(3,"0"),s(),n(4,"div",2),l(5,"div",3),n(6,"div",4)(7,"div",5)(8,"h2"),o(9,"Snake"),s(),n(10,"input",6),u("click",function(){return i.startFunction()}),s(),n(11,"div",7)(12,"p"),o(13,"Mobile Controls: "),s(),n(14,"p"),o(15,"Swipe to move"),s(),l(16,"br"),n(17,"p"),o(18,"PC Controls:"),s(),n(19,"p"),o(20,"Arrow keys"),s()()()()())},styles:["h1[_ngcontent-%COMP%]{text-align:center;display:block}h2[_ngcontent-%COMP%]{text-align:center;margin:0}.snake-page[_ngcontent-%COMP%]{min-height:85vh;width:99vw;display:flex;justify-content:center;align-items:center;margin:0;background-color:#000}#game-board[_ngcontent-%COMP%]{background-color:#ccc;width:80vmin;height:80vmin;display:none;grid-template-rows:repeat(21,1fr);grid-template-columns:repeat(21,1fr)}#splashscreen[_ngcontent-%COMP%]{width:80vw;height:80vh;text-align:center;animation:_ngcontent-%COMP%_rotate-bg-color 30s infinite}@keyframes _ngcontent-%COMP%_rotate-bg-color{0%{background-color:#4682b4}50%{background-color:indigo}to{background-color:#4682b4}}#splashscreen-content[_ngcontent-%COMP%]{margin-top:35vh}#splashscreen[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:25%;width:25%}#controls-style[_ngcontent-%COMP%]{border:white 1px solid;margin-left:auto;margin-right:auto;margin-top:3vh;width:40%}"]});let h=a;return h})();export{p as SnakePage};
